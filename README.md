# Welding Report API

–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–æ–≤ –ø–æ —Å–≤–∞—Ä–æ—á–Ω—ã–º —Ä–∞–±–æ—Ç–∞–º –∏ –∑–∞—è–≤–∫–∞–º –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Å–∏—Å—Ç–µ–º—ã Redmine.

## –û–ø–∏—Å–∞–Ω–∏–µ

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π REST API —Å–µ—Ä–≤–∏—Å, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –Ω–∞ ASP.NET Core 8.0, –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –æ—Ç—á–µ—Ç–æ–≤:

- **–û—Ç—á–µ—Ç—ã –ø–æ –∑–∞—è–≤–∫–∞–º** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è Word –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ pr_redmine
- **–û—Ç—á–µ—Ç—ã –ø–æ —Å–≤–∞—Ä–æ—á–Ω—ã–º —Ä–∞–±–æ—Ç–∞–º** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è Excel —Ñ–∞–π–ª–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ svarka
- **–û—Ç—á–µ—Ç—ã –°–£–ü–†** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è Excel —Ñ–∞–π–ª–æ–≤ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –°–£–ü–†

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üìÑ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤
- **Word –æ—Ç—á–µ—Ç—ã** - —Å–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ –∑–∞—è–≤–∫–∞–º —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö
- **Excel –æ—Ç—á–µ—Ç—ã** - —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—á–Ω—ã—Ö –æ—Ç—á–µ—Ç–æ–≤ –ø–æ —Å–≤–∞—Ä–æ—á–Ω—ã–º —Ä–∞–±–æ—Ç–∞–º –∏ –ø—Ä–æ–µ–∫—Ç–∞–º
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç—á–µ—Ç–æ–≤ –Ω–∞ email

### üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- **Redmine API** - –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ Redmine
- **Email —Å–µ—Ä–≤–∏—Å** - –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á–µ—Ç–æ–≤ —á–µ—Ä–µ–∑ SMTP (Yandex)
- **–§–∞–π–ª–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ** - –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

### üé® –®–∞–±–ª–æ–Ω—ã
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —à–∞–±–ª–æ–Ω–æ–≤ Word (.docx) –∏ Excel (.xlsx)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ API
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–∏–ª–µ–π –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **.NET 8.0** - –æ—Å–Ω–æ–≤–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞
- **ASP.NET Core** - –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **DocumentFormat.OpenXml** - —Ä–∞–±–æ—Ç–∞ —Å Word –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏
- **EPPlus** - —Ä–∞–±–æ—Ç–∞ —Å Excel —Ñ–∞–π–ª–∞–º–∏
- **SkiaSharp** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **Swagger** - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
- **Docker** - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
welding-report/
‚îú‚îÄ‚îÄ Controllers/           # API –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
‚îú‚îÄ‚îÄ Models/               # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îú‚îÄ‚îÄ Services/             # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –∏ —Å–µ—Ä–≤–∏—Å—ã
‚îÇ   ‚îú‚îÄ‚îÄ Request/         # –°–µ—Ä–≤–∏—Å—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∑–∞—è–≤–∫–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ Welding/         # –°–µ—Ä–≤–∏—Å—ã –¥–ª—è —Å–≤–∞—Ä–æ—á–Ω—ã—Ö —Ä–∞–±–æ—Ç
‚îÇ   ‚îî‚îÄ‚îÄ Supr/            # –°–µ—Ä–≤–∏—Å—ã –¥–ª—è –°–£–ü–†
‚îú‚îÄ‚îÄ Resources/           # –®–∞–±–ª–æ–Ω—ã –∏ —Ä–µ—Å—É—Ä—Å—ã
‚îÇ   ‚îî‚îÄ‚îÄ Templates/       # –®–∞–±–ª–æ–Ω—ã –æ—Ç—á–µ—Ç–æ–≤
‚îî‚îÄ‚îÄ Program.cs           # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```

## API Endpoints

### –û—Ç—á–µ—Ç—ã –ø–æ –∑–∞—è–≤–∫–∞–º
- `GET /api/WeldingReport/generate-issue-from-request` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è Word –æ—Ç—á–µ—Ç–∞ –ø–æ –∑–∞—è–≤–∫–µ

### –û—Ç—á–µ—Ç—ã –ø–æ —Å–≤–∞—Ä–æ—á–Ω—ã–º —Ä–∞–±–æ—Ç–∞–º
- `GET /api/WeldingReport/generate-issue-from-welding` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è Excel –æ—Ç—á–µ—Ç–∞ –ø–æ –∑–∞–¥–∞—á–µ
- `GET /api/WeldingReport/generate-project-from-welding` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è Excel –æ—Ç—á–µ—Ç–∞ –ø–æ –ø—Ä–æ–µ–∫—Ç—É

### –û—Ç—á–µ—Ç—ã –°–£–ü–†
- `GET /api/WeldingReport/generate-group-from-supr` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è Excel –æ—Ç—á–µ—Ç–∞ –°–£–ü–†

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `appsettings.json`:

- **AppSettings** - –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **EmailSettings** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SMTP —Å–µ—Ä–≤–µ—Ä–∞
- **RedmineSettings** - URL –∏ API –∫–ª—é—á–∏ –¥–ª—è Redmine
- **SuprSignatures** - –ø–æ–¥–ø–∏—Å–∏ –¥–ª—è –æ—Ç—á–µ—Ç–æ–≤ –°–£–ü–†

## –ó–∞–ø—É—Å–∫

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
```bash
cd welding-report
dotnet run
```

### Docker
```bash
docker build -t welding-report .
docker run -p 8080:8080 welding-report
```

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Swagger –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É:
- http://localhost:8080/swagger

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- .NET 8.0 SDK
- Docker (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –î–æ—Å—Ç—É–ø –∫ Redmine API
- –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π SMTP —Å–µ—Ä–≤–µ—Ä –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ email

## –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç EPPlus –≤ –Ω–µ–∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–º —Ä–µ–∂–∏–º–µ. 